import{t as h,a as v}from"./ClnZs9JQ.js";import{av as m,a9 as E,aw as _,h as k,v as g,q as c,u as d,o as j}from"./l0T6cHFi.js";import{s as y,a as w}from"./YrPL4FWa.js";import{s as b,r as x,a as T}from"./B_K-PZOM.js";import{r as p,p as C}from"./D0Py5RU9.js";import{l as S}from"./TA4MYeQV.js";function $(t,e,s=e){var a=m();S(t,"input",r=>{var n=r?t.defaultValue:t.value;if(n=i(t)?u(n):n,s(n),a&&n!==(n=e())){var l=t.selectionStart,o=t.selectionEnd;t.value=n??"",o!==null&&(t.selectionStart=l,t.selectionEnd=Math.min(o,t.value.length))}}),(k&&t.defaultValue!==t.value||E(e)==null&&t.value)&&s(i(t)?u(t.value):t.value),_(()=>{var r=e();i(t)&&r===u(t.value)||t.type==="date"&&!r&&!t.value||r!==t.value&&(t.value=r??"")})}function i(t){var e=t.type;return e==="number"||e==="range"}function u(t){return t===""?null:+t}var L=h("<button><!></button>");function M(t,e){let s=p(e,["$$slots","$$events","$$legacy","children"]);var a=L();let r;var n=c(a);y(n,()=>e.children),d(a),g(()=>r=b(a,r,{...s,class:"group inline-flex items-center justify-center rounded-full bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-500 focus:outline-none active:bg-blue-800 active:text-blue-100"})),v(t,a)}const A="http://localhost:5000";class q{async register(e,s){console.log("here");let a=await this.call("/user/register","POST",{hash:e,password:s});if(a.status===201)return{jwt:(await a.json()).jwt,redirect:void 0};throw new Error("Error response!"+a.status)}async getUserQuestions(e){let s=await this.call(`/user/${e}`,"GET");if(s.status!==200)throw Error("failed get user question");return(await s.json()).result.questions}async getQuestions(){let e=await this.call("/question","GET");if(e.status!==200)throw Error("failed get questions");let s=await e.json(),a=[];return s.result.questions.forEach(r=>{r.key!==1&&a.push({key:r.key,content:r.content})}),a}async patchUser(e,s,a){const r=[];for(const l of s)r.push({key:l.key,answer:await w(l.content)});if((await this.call(`/user/${e}`,"PATCH",{add:r,delete:a})).status!==200)throw Error("cannot update profile");return!0}async login(e,s){let a=await this.call(`/login/${e}`,"POST",{password:s});if(a.status===401)throw new Error(await a.text());if(a.status!==201)throw new Error("Something went wrong!");let r=await a.json();return{jwt:r.jwt??void 0,redirect:r.redirect}}async getChallenge(e){let s=await this.call(`/login/${e}/challenge`,"GET");if(s.status!==200)throw Error("cannot get challenge!");let a=await s.json();const r=[];return a.result.questions.forEach(n=>{r.push({key:n.key,content:n.content})}),r}async answerChallenge(e,s,a){const r=[];for(const o of s)r.push({key:o.key,answer:await w(o.content)});let n=await this.call(`/login/${e}/answer`,"POST",{answers:r,key:a.key,signature:a.signature});if(n.status===400)throw new Error(await n.text());if(n.status!==201)throw new Error("Something went wrong!");return{jwt:(await n.json()).jwt,redirect:void 0}}async deleteUser(e){if((await this.call(`/user/${e}`,"DELETE")).status!==204)throw new Error("Cannot delete!")}async call(e,s,a=null){return await fetch(A+e,{method:s,headers:{"Content-Type":"application/json"},body:a?JSON.stringify(a):void 0})}}const N=()=>new q,Q=!0;var P=h('<div><label class="mb-3 block text-sm font-medium text-gray-700"><!></label> <input></div>');function V(t,e){let s=C(e,"value",15),a=p(e,["$$slots","$$events","$$legacy","id","children","value"]);var r=P(),n=c(r),l=c(n);y(l,()=>e.children),d(n);var o=j(n,2);x(o);let f;d(r),g(()=>{T(n,"for",e.id),f=b(o,f,{...a,id:e.id,class:"block w-full appearance-none rounded-md border border-gray-200 bg-gray-50 px-3 py-2 text-gray-900 placeholder-gray-400 focus:border-blue-500 focus:bg-white focus:outline-none focus:ring-blue-500 sm:text-sm"})}),$(o,s),v(t,r)}export{M as B,Q as C,V as I,N as g};
