import{t as q,h as D,a as c,b as y}from"../chunks/ClnZs9JQ.js";import{j as E,k as g,l as I,$ as P,m as u,n as a,o as b,q as f,t as _,u as v,v as M}from"../chunks/l0T6cHFi.js";import{s as z}from"../chunks/8GF0UDw8.js";import{e as H,i as L}from"../chunks/OtK21MUW.js";import{e as T}from"../chunks/TA4MYeQV.js";import{p as o}from"../chunks/DMxfHGK6.js";import{o as U}from"../chunks/CR20OqM2.js";import{g as W,B as A,d as F}from"../chunks/YrPL4FWa.js";import{i as G}from"../chunks/B_K-PZOM.js";import{B as J,g as K,I as N}from"../chunks/CC3nbQox.js";import{g as k}from"../chunks/CdX3Ss7s.js";var O=q('<div class="mx-auto mb-10 mt-20 max-w-2xl"><div class="mb-10"><h3 class="mb-2 mt-4">Challenge</h3></div> <div><form class="mt-10 grid grid-cols-1 gap-y-8"><!> <!></form></div></div>');function ot(C,B){E(B,!0);let h=K(),m=g(""),n=g(o([])),i=g(o([]));U(async()=>{if(u(m,o(await W())),u(n,o(await h.getChallenge(a(m)))),a(n).length===0){k(A+"/login");return}let t=[];a(n).forEach(e=>{t.push({key:e.key,content:""})}),u(i,o(t))});async function S(t){t.preventDefault();try{let e=await window.cardano.eternl.enable(),s=await e.getUsedAddresses();const r=Math.floor(Date.now()/1e3)*1e3-10*60*1e3;let x=await e.signData(s[0],"0"+r.toString(16)),l=await h.answerChallenge(a(m),a(i),x);document.cookie=F.serialize("jwt",l.jwt,{path:"/",maxAge:60*60}),G.set(!0),k(A+"/")}catch(e){window.alert("failed! "+e.message)}}var p=O();D(t=>{P.title="Challenge"});var w=b(f(p),2),d=f(w),$=f(d);H($,17,()=>a(n),L,(t,e,s)=>{N(t,{type:"text",id:"quest"+s,get value(){return a(i)[s].content},set value(r){a(i)[s].content=r},children:(r,x)=>{_();var l=y();M(()=>z(l,a(e).content)),c(r,l)},$$slots:{default:!0}})});var j=b($,2);J(j,{type:"submit",children:(t,e)=>{_();var s=y("Answer");c(t,s)},$$slots:{default:!0}}),v(d),v(w),v(p),T("submit",d,S),c(C,p),I()}export{ot as component};
