import{t as L,a as d,h as Q,b as w}from"../chunks/D0T786_O.js";import{v as U,k as c,q as m,t as T,m as g,u as W,$ as Y,j as x,l as h,o as r,n as _}from"../chunks/BdVy2I1O.js";import{s as z}from"../chunks/N11n9GH2.js";import{e as H,i as K}from"../chunks/C3DpXuVZ.js";import{e as M}from"../chunks/vAJXdrVo.js";import{p as i}from"../chunks/CEkGUXtm.js";import{o as R}from"../chunks/BGZH7JQ1.js";import{s as F,d as G}from"../chunks/Drj6_Kw3.js";import{i as J}from"../chunks/DpOeENrT.js";import{B as N,I as O}from"../chunks/wBQbu8wO.js";import{g as D}from"../chunks/BWv1usOB.js";import{g as V,C as X}from"../chunks/BWD5dW6K.js";import{s as Z}from"../chunks/Cxmu4Wft.js";import{r as tt}from"../chunks/ChzcKbe0.js";import{g as et,B as E}from"../chunks/C6fDkkBA.js";var ot=L("<button><!></button>");function at(y,p){let n=tt(p,["$$slots","$$events","$$legacy","children"]);var s=ot();let l;var u=c(s);F(u,()=>p.children),m(s),U(()=>l=Z(s,l,{...n,class:"group inline-flex items-center justify-center rounded-full bg-red-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-500 focus:outline-none active:bg-blue-800 active:text-blue-100"})),d(y,s)}var rt=L('<div class="mx-auto mb-10 mt-20 max-w-2xl"><div class="mb-10"><h3 class="mb-2 mt-4">Profile</h3></div> <div><form class="mt-10 grid grid-cols-1 gap-y-8"><!> <div><!> <!></div></form></div></div>');function $t(y,p){T(p,!0);let n=V(),s=g(""),l=g(i([])),u=g(i([])),f=g(i([]));function j(t){return Array.from(t).map(e=>e.charCodeAt(0).toString(16).padStart(2,"0")).join("")}R(async()=>{h(u,i(await n.getQuestions()));let t=[];r(u).forEach(e=>{t.push({key:e.key,content:""})}),h(f,i(t)),h(s,i(await et())),h(l,i(await n.getUserQuestions(r(s))))});async function C(t){if(t.preventDefault(),!!window.confirm("You are about to update your account. Are you sure?"))try{const e=[],a=[];if(r(f).forEach(o=>{o.content!==""&&r(l).includes(o.key)&&a.push(o.key),o.content!==""&&e.push(o)}),X){let o=await window.cardano.eternl.enable(),S=await o.getUsedAddresses(),v=await o.signData(S[0],j("confirm your action"));console.log(v)}await n.patchUser(r(s),e,a),D(E+"/")}catch(e){window.alert("failed! "+e.message)}}async function q(t){if(t.preventDefault(),!!window.confirm("You are about to delete your account. Are you sure?"))try{await n.deleteUser(r(s)),document.cookie=G.serialize("jwt","",{path:"/",expires:new Date(0)}),J.set(!1),D(E+"/")}catch(e){window.alert("failed! "+e.message)}}var b=rt();Q(t=>{Y.title="Profile"});var A=x(c(b),2),$=c(A),P=c($);H(P,17,()=>r(u),K,(t,e,a)=>{O(t,{type:"text",id:"quest"+a,get value(){return r(f)[a].content},set value(o){r(f)[a].content=o},children:(o,S)=>{_();var v=w();U(()=>z(v,r(e).content)),d(o,v)},$$slots:{default:!0}})});var k=x(P,2),B=c(k);N(B,{type:"submit",children:(t,e)=>{_();var a=w("Update Profile");d(t,a)},$$slots:{default:!0}});var I=x(B,2);at(I,{onclick:q,children:(t,e)=>{_();var a=w("Delete Profile");d(t,a)},$$slots:{default:!0}}),m(k),m($),m(A),m(b),M("submit",$,C),d(y,b),W()}export{$t as component};
